# Creating a Volume Mesh for the Brain Domain

## Software Installation
A `Dockerfile` is provided in the `docker` subdirectory to build an appropriate environment for use with ITK.

## Pre-processing
It is necessary to first prepare the data by aligning coordinate systems of the data and generating surfaces for the important anatomical features. Please consult the pre-processing pipline [README](../preprocessing/README.md) for details.

## Volume mesh generation
The [SVM-Tk software](https://github.com/SVMTK/SVMTK) is utilized to generate volume meshes for the complicated brain domain. Many of the scripts utilized in this work are adapted from the book
> Mardal, Kent-Andr√©, et al. Mathematical modeling of the human brain: from magnetic resonance images to finite element simulation. Vol. 10. Springer Nature, 2022.

The main mesh generation script is `mesh_generator.py` and supports gray/white/ventricular meshing for both, or either hemisphere. For more information, call

```
python3 mesh_generator.py --help
```

For development, it may be useful to instead only resolve and evolve equations on a two-dimensional domain. The (strong) assumption is made that one wishes to slice along the axial plane. Functionality is provided for the user to specify the z-axis coordinate (in `FreeSurfer` / volume mesh coordinates) for the plane to slice the 3D geometry, but the user must specify both `--gdim 2` and supply a `--zoff` value.

## Miscellaneous
Other scripts in this directory include
- `refine_mesh.py` which uses `FEniCS` to post-process and refine meshes generated by `SVMTK`.
- `single_domain_mesh_generator.py` which can be useful to mesh only the pial surface.
- `generate_box_mesh.py` which computes a bounding box of a surface and generates an isotropic mesh of the rectangular prism.

## Under construction
- `slice_mesh_generator.py` which generates a mesh of a slice of a domain.
